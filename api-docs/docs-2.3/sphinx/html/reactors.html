<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>

    <title>Reactors and Reactor Networks &#8212; Cantera 2.3.0 documentation</title>
    <link rel="stylesheet" href="_static/cantera.css" type="text/css">
    <link rel="stylesheet" href="_static/pygments.css" type="text/css">
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico">
    <link rel="author" title="About these documents" href="about.html">
    <link rel="index" title="Index" href="genindex.html">
    <link rel="search" title="Search" href="search.html">
    <link rel="next" title="One-Dimensional Flames" href="flames.html">
    <link rel="prev" title="Example: Hydrogen Combustion" href="cti/example-combustion.html">
  <meta content="noindex" name="robots"></head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html">
<img src="_static/cantera-logo.png" border="0" alt="Cantera"></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index" accesskey="I">index</a></li>
        <li class="right">
          <a href="py-modindex.html" title="Python Module Index">modules</a> |</li>
        <li class="right">
          <a href="flames.html" title="One-Dimensional Flames" accesskey="N">next</a> |</li>
        <li class="right">
          <a href="cti/example-combustion.html" title="Example: Hydrogen Combustion" accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Cantera</a> &#187;</li>
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Reactors and Reactor Networks</a><ul>
<li><a class="reference internal" href="#governing-equations-for-single-reactors">Governing Equations for Single Reactors</a><ul>
<li><a class="reference internal" href="#mass-conservation">Mass Conservation</a></li>
<li><a class="reference internal" href="#species-conservation">Species Conservation</a></li>
<li><a class="reference internal" href="#reactor-volume">Reactor Volume</a></li>
<li><a class="reference internal" href="#energy-conservation">Energy Conservation</a><ul>
<li><a class="reference internal" href="#standard-reactor">Standard Reactor</a></li>
<li><a class="reference internal" href="#constant-pressure-reactor">Constant Pressure Reactor</a></li>
<li><a class="reference internal" href="#ideal-gas-reactor">Ideal Gas Reactor</a></li>
<li><a class="reference internal" href="#ideal-gas-constant-pressure-reactor">Ideal Gas Constant Pressure Reactor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wall-interactions">Wall Interactions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reactor-networks-and-devices">Reactor Networks and Devices</a><ul>
<li><a class="reference internal" href="#time-integration">Time Integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#general-usage-in-cantera">General Usage in Cantera</a></li>
<li><a class="reference internal" href="#common-reactor-types-and-their-implementation-in-cantera">Common Reactor Types and their Implementation in Cantera</a><ul>
<li><a class="reference internal" href="#batch-reactor-at-constant-volume-or-at-constant-pressure">Batch Reactor at Constant Volume or at Constant Pressure</a></li>
<li><a class="reference internal" href="#continuously-stirred-tank-reactor">Continuously Stirred Tank Reactor</a></li>
<li><a class="reference internal" href="#plug-flow-reactor">Plug-Flow Reactor</a><ul>
<li><a class="reference internal" href="#pfr-modeling-by-considering-a-lagrangian-reactor">PFR Modeling by Considering a Lagrangian Reactor</a></li>
<li><a class="reference internal" href="#pfr-modeling-as-a-series-of-cstrs">PFR Modeling as a Series of CSTRs</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-concepts">Advanced Concepts</a></li>
<li><a class="reference internal" href="#literature">Literature</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cti/example-combustion.html" title="previous chapter">Example: Hydrogen Combustion</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="flames.html" title="next chapter">One-Dimensional Flames</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/reactors.rst.txt" rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q"></div>
      <div><input type="submit" value="Go"></div>
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div id="numfocus">
<h3>Donate to Cantera</h3>
<a href="https://numfocus.org/donate-to-cantera">
<img src="_static/powered_by_NumFOCUS.png" border="0" alt="NumFOCUS"></a>
</div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">

  <blockquote><div><div class="admonition warning"><p class="first admonition-title">Warning</p><p class="last">This documentation is for an old version of Cantera. You can find docs for newer versions <a class="reference external" href="https://cantera.org/documentation">here</a>.</p></div></div></blockquote><div class="section" id="reactors-and-reactor-networks">
<h1>Reactors and Reactor Networks<a class="headerlink" href="#reactors-and-reactor-networks" title="Permalink to this headline">&#182;</a></h1>
<p>A Cantera Reactor represents the simplest form of a chemically reacting system.
It corresponds to an extensive thermodynamic control volume <span class="math">\(V\)</span>, in which all
state variables are homogeneously distributed. The system is generally unsteady,
i.e. all states are functions of time. In particular, transient state changes
due to chemical reactions are possible. However, thermodynamic (but not
chemical) equilibrium is assumed to be present throughout the reactor at all
instants of time.</p>
<p>Reactors can interact with the surrounding environment in multiple ways:</p>
<ul class="simple">
<li>Expansion/compression work: By moving the walls of the reactor, its volume can
be changed and expansion or compression work can be done by or on the system,
i.e., the Reactor.</li>
<li>Heat transfer: An arbitrary heat transfer rate can be defined to cross the
boundaries of the reactor.</li>
<li>Mass transfer: The reactor can have multiple inlets and outlets. For the
inlets, arbitrary states can be defined. Through the outlets, fluid with the
current state of the reactor exits the reactor.</li>
<li>Surface interaction: One or multiple walls can influence the chemical
reactions in the reactor. This is not just restricted to catalytic reactions,
but mass transfer between the surface and the fluid can also be modeled.</li>
</ul>
<p>All of these interactions do not have to be constant, but can vary as a function
of time or state. For example, heat transfer can be described as a function of
the temperature difference between the reactor and the environment, or the wall
movement can be modeled depending on the pressure difference. Typically,
interactions of the reactor with the environment are defined on one or multiple
<em>walls</em>, <em>inlets</em>, and <em>outlets</em>.</p>
<p>In addition to single reactors, Cantera is also able to interconnect reactors
into a <em>Reactor Network</em>. Each reactor in a network may be connected so that
the contents of one reactor flow into another. Reactors may also be in contact
with one another or the environment via walls which move or conduct heat.</p>
<div class="section" id="governing-equations-for-single-reactors">
<h2>Governing Equations for Single Reactors<a class="headerlink" href="#governing-equations-for-single-reactors" title="Permalink to this headline">&#182;</a></h2>
<p>The state variables for Cantera&#8217;s general reactor model are</p>
<ul class="simple">
<li><span class="math">\(m\)</span>, the mass of the reactor&#8217;s contents (in kg)</li>
<li><span class="math">\(V\)</span>, the reactor volume (in m<sup>3</sup>) (not a state variable for
<em>Constant Pressure Reactor</em> and <em>Ideal Gas Constant Pressure Reactor</em>)</li>
<li>A state variable describing the energy of the system, depending on the
configuration (see <a class="reference internal" href="#energy-conservation">Energy Conservation</a> for further explanation):<ul>
<li>General <em>Reactor</em>: <span class="math">\(U\)</span>, the total internal energy of the reactors
contents (in J)</li>
<li><em>Constant Pressure Reactor</em>: <span class="math">\(H\)</span>, the total enthalpy of the reactors
contents (in J)</li>
<li><em>Ideal Gas Reactor</em> and <em>Ideal Gas Constant Pressure Reactor</em>: <span class="math">\(T\)</span>, the
temperature (in K)</li>
</ul>
</li>
<li><span class="math">\(Y_k\)</span>, the mass fractions for each species (dimensionless)</li>
</ul>
<div class="section" id="mass-conservation">
<h3>Mass Conservation<a class="headerlink" href="#mass-conservation" title="Permalink to this headline">&#182;</a></h3>
<p>The total mass of the reactor&#8217;s contents changes as a result of flow through
the reactor&#8217;s inlets and outlets, and production of homogeneous phase species
on the reactor walls:</p>
<div class="math">
\[\frac{dm}{dt} = \sum_{in} \dot{m}_{in} - \sum_{out} \dot{m}_{out} +
                \dot{m}_{wall}\]</div>
</div>
<div class="section" id="species-conservation">
<h3>Species Conservation<a class="headerlink" href="#species-conservation" title="Permalink to this headline">&#182;</a></h3>
<p>The rate at which species <span class="math">\(k\)</span> is generated through homogeneous phase reactions
is <span class="math">\(V \dot{\omega}_k W_k\)</span>, and the total rate at which species <span class="math">\(k\)</span> is generated
is:</p>
<div class="math">
\[\dot{m}_{k,gen} = V \dot{\omega}_k W_k + \dot{m}_{k,wall}\]</div>
<p>The rate of change in the mass of each species is:</p>
<div class="math">
\[\frac{d(mY_k)}{dt} = \sum_{in} \dot{m}_{in} Y_{k,in} -
                     \sum_{out} \dot{m}_{out} Y_k +
                     \dot{m}_{k,gen}\]</div>
<p>Expanding the derivative on the left hand side and substituting the equation
for <span class="math">\(dm/dt\)</span>, the equation for each homogeneous phase species is:</p>
<div class="math">
\[m \frac{dY_k}{dt} = \sum_{in} \dot{m}_{in} (Y_{k,in} - Y_k)+
                  \dot{m}_{k,gen} - Y_k \dot{m}_{wall}\]</div>
</div>
<div class="section" id="reactor-volume">
<h3>Reactor Volume<a class="headerlink" href="#reactor-volume" title="Permalink to this headline">&#182;</a></h3>
<p>The reactor volume changes as a function of time due to the motion of one or
more walls:</p>
<div class="math">
\[\frac{dV}{dt} = \sum_w f_w A_w v_w(t)\]</div>
<p>where <span class="math">\(f_w = \pm 1\)</span> indicates the facing of the wall, <span class="math">\(A_w\)</span> is the surface
area of the wall, and <span class="math">\(v_w(t)\)</span> is the velocity of the wall as a function of
time.</p>
<p>For <em>Constant Pressure Reactor</em> and <em>Ideal Gas Constant Pressure Reactor</em>, the
volume is not a state variable, but instead takes on whatever value is
consistent with holding the pressure constant.</p>
</div>
<div class="section" id="energy-conservation">
<h3>Energy Conservation<a class="headerlink" href="#energy-conservation" title="Permalink to this headline">&#182;</a></h3>
<p>The solution of the energy equation can be enabled or disabled by changing the
<code class="docutils literal"><span class="pre">energy_enabled</span></code> flag. It is enabled by default.</p>
<p>The implemented formulation of the energy equation depends on which reactor
model is used.</p>
<div class="section" id="standard-reactor">
<h4>Standard Reactor<a class="headerlink" href="#standard-reactor" title="Permalink to this headline">&#182;</a></h4>
<p>The equation for the total internal energy is found by writing the first law
for an open system:</p>
<div class="math">
\[\frac{dU}{dt} = - p \frac{dV}{dt} - \dot{Q} +
                \sum_{in} \dot{m}_{in} h_{in} - h \sum_{out} \dot{m}_{out}\]</div>
</div>
<div class="section" id="constant-pressure-reactor">
<h4>Constant Pressure Reactor<a class="headerlink" href="#constant-pressure-reactor" title="Permalink to this headline">&#182;</a></h4>
<p>For this reactor model, the pressure is held constant. The volume is not a
state variable, but instead takes on whatever value is consistent with holding
the pressure constant. The total enthalpy replaces the total internal energy
as a state variable. Using the definition of the total enthalpy:</p>
<div class="math">
\[ \begin{align}\begin{aligned}H = U + pV\\\frac{d H}{d t} = \frac{d U}{d t} + p \frac{dV}{dt} + V \frac{dp}{dt}\end{aligned}\end{align} \]</div>
<p>Noting that <span class="math">\(dp/dt = 0\)</span> and substituting into the energy equation yields:</p>
<div class="math">
\[\frac{dH}{dt} = - \dot{Q} + \sum_{in} \dot{m}_{in} h_{in}
                - h \sum_{out} \dot{m}_{out}\]</div>
</div>
<div class="section" id="ideal-gas-reactor">
<h4>Ideal Gas Reactor<a class="headerlink" href="#ideal-gas-reactor" title="Permalink to this headline">&#182;</a></h4>
<p>In case of the Ideal Gas Reactor Model, the reactor temperature <span class="math">\(T\)</span> is used
instead of the total internal energy <span class="math">\(U\)</span> as a state variable. For an ideal gas,
we can rewrite the total internal energy in terms of the mass fractions and
temperature:</p>
<div class="math">
\[ \begin{align}\begin{aligned}U = m \sum_k Y_k u_k(T)\\\frac{dU}{dt} = u \frac{dm}{dt}
                + m c_v \frac{dT}{dt}
                + m \sum_k u_k \frac{dY_k}{dt}\end{aligned}\end{align} \]</div>
<p>Substituting the corresponding derivatives yields an equation for the
temperature:</p>
<div class="math">
\[m c_v \frac{dT}{dt} = - p \frac{dV}{dt} - \dot{Q}
    + \sum_{in} \dot{m}_{in} \left( h_{in} - \sum_k u_k Y_{k,in} \right)
    - \frac{p V}{m} \sum_{out} \dot{m}_{out} - \sum_k \dot{m}_{k,gen} u_k\]</div>
<p>While this form of the energy equation is somewhat more complicated, it
significantly reduces the cost of evaluating the system Jacobian, since the
derivatives of the species equations are taken at constant temperature instead
of constant internal energy.</p>
</div>
<div class="section" id="ideal-gas-constant-pressure-reactor">
<h4>Ideal Gas Constant Pressure Reactor<a class="headerlink" href="#ideal-gas-constant-pressure-reactor" title="Permalink to this headline">&#182;</a></h4>
<p>As for the Ideal Gas Reactors, we replace the total enthalpy as a state
variable with the temperature by writing the total enthalpy in terms of the
mass fractions and temperature:</p>
<div class="math">
\[ \begin{align}\begin{aligned}H = m \sum_k Y_k h_k(T)\\\frac{dH}{dt} = h \frac{dm}{dt} + m c_p \frac{dT}{dt}
                + m \sum_k h_k \frac{dY_k}{dt}\end{aligned}\end{align} \]</div>
<p>Substituting the corresponding derivatives yields an equation for the
temperature:</p>
<div class="math">
\[m c_p \frac{dT}{dt} = - \dot{Q} - \sum_k h_k \dot{m}_{k,gen}
    + \sum_{in} \dot{m}_{in} \left(h_{in} - \sum_k h_k Y_{k,in} \right)\]</div>
</div>
</div>
<div class="section" id="wall-interactions">
<h3>Wall Interactions<a class="headerlink" href="#wall-interactions" title="Permalink to this headline">&#182;</a></h3>
<p>The total rate of heat transfer through all walls is:</p>
<div class="math">
\[\dot{Q} = \sum_w f_w \dot{Q}_w\]</div>
<p>where <span class="math">\(f_w = \pm 1\)</span> indicates the facing of the wall (+1 for the reactor on the
left, -1 for the reactor on the right). The heat flux <span class="math">\(\dot{Q}_w\)</span> through a wall
<span class="math">\(k\)</span> connecting reactors &#8220;left&#8221; and &#8220;right&#8221; is computed as:</p>
<div class="math">
\[\dot{Q}_w = U A (T_{\rm left} - T_{\rm right})
          + \epsilon\sigma A (T_{\rm left}^4 - T_{\rm right}^4)
          + A q_0(t)\]</div>
<p>where <span class="math">\(U\)</span> is a user-specified heat transfer coefficient (W/m^2-K), <span class="math">\(A\)</span> is the
wall area (m^2), <span class="math">\(\epsilon\)</span> is the user-specified emissivity, <span class="math">\(\sigma\)</span> is the
Stefan-Boltzmann radiation constant, and <span class="math">\(q_0(t)\)</span> is a user-specified,
time-dependent heat flux (W/m^2). This definition is such that positive <span class="math">\(q_0(t)\)</span>
implies heat transfer from the &#8220;left&#8221; reactor to the &#8220;right&#8221; reactor. Each of
the user-specified terms defaults to 0.</p>
<p>In case of surface reactions, there can be a net generation (or destruction) of
homogeneous (gas) phase species at the wall. The molar rate of production for
each homogeneous phase species <span class="math">\(k\)</span> on wall <span class="math">\(w\)</span> is <span class="math">\(\dot{s}_{k,w}\)</span> (in
kmol/s/m^2). The total (mass) production rate for homogeneous phase species <span class="math">\(k\)</span>
on all walls is:</p>
<div class="math">
\[\dot{m}_{k,wall} = W_k \sum_w A_w \dot{s}_{k,w}\]</div>
<p>where <span class="math">\(W_k\)</span> is the molecular weight of species <span class="math">\(k\)</span> and <span class="math">\(A_w\)</span> is the area of
each wall. The net mass flux from all walls is then:</p>
<div class="math">
\[\dot{m}_{wall} = \sum_k \dot{m}_{k,wall}\]</div>
<p>For each surface species <span class="math">\(i\)</span>, the rate of change of the site fraction
<span class="math">\(\theta_{i,w}\)</span> on each wall <span class="math">\(w\)</span> is integrated with time:</p>
<div class="math">
\[\frac{d\theta_{i,w}}{dt} = \frac{\dot{s}_{i,w} n_i}{\Gamma_w}\]</div>
<p>where <span class="math">\(\Gamma_w\)</span> is the total surface site density on wall <span class="math">\(w\)</span> and <span class="math">\(n_i\)</span> is the
number of surface sites occupied by a molecule of species <span class="math">\(i\)</span> (sometimes
referred to within Cantera as the molecule&#8217;s &#8220;size&#8221;).</p>
</div>
</div>
<div class="section" id="reactor-networks-and-devices">
<h2>Reactor Networks and Devices<a class="headerlink" href="#reactor-networks-and-devices" title="Permalink to this headline">&#182;</a></h2>
<p>While reactors by themselves just define the above governing equations of the
reactor, the time integration is performed in reactor networks. A reactor
network is therefore necessary even if only a single reactor is considered.</p>
<p>The advantage of reactor networks obviously is that multiple reactors can be
interconnected. Not only mass flow from one reactor into another can be
realized, but also heat can be transferred, or the wall between reactors can
move. To set up a network, the following components can be defined in addition
to the reactors previously mentioned:</p>
<ul>
<li><p class="first"><strong>Reservoir</strong>: A reservoir can be thought of as an infinitely large volume, in
which all states are predefined and never change from their initial values.
Typically, it represents a vessel to define temperature and composition of a
stream of mass flowing into a reactor, or the ambient fluid surrounding the
reactor network. Besides, the fluid flow finally finally exiting a reactor
network has to flow into a reservoir. In the latter case, the state of the
reservoir (except pressure) is irrelevant.</p>
</li>
<li><p class="first"><strong>Wall</strong>: A wall separates two reactors, or a reactor and a reservoir. A wall
has a finite area, may conduct or radiate heat between the two reactors on
either side, and may move like a piston.</p>
<p>Walls are stateless objects in Cantera, meaning that no differential equation
is integrated to determine any wall property. Since it is the wall (piston)
velocity that enters the energy equation, this means that it is the velocity,
not the acceleration or displacement, that is specified. The wall velocity is
computed from</p>
<div class="math">
\[v = K(P_{\rm left} - P_{\rm right}) + v_0(t),\]</div>
<p>where <span class="math">\(K\)</span> is a non-negative constant, and <span class="math">\(v_0(t)\)</span> is a specified
function of time. The velocity is positive if the wall is moving to the right.</p>
<p>The heat flux through the wall is computed from</p>
<div class="math">
\[q = U(T_{\rm left} - T_{\rm right}) + \epsilon\sigma (T_{\rm left}^4
- T_{\rm right}^4) + q_0(t),\]</div>
<p>where <span class="math">\(U\)</span> is the overall heat transfer coefficient for
conduction/convection, and <span class="math">\(\epsilon\)</span> is the emissivity. The function
<span class="math">\(q_0(t)\)</span> is a specified function of time. The heat flux is positive when
heat flows from the reactor on the left to the reactor on the right.</p>
<p>A heterogeneous reaction mechanism may be specified for one or both of the
wall surfaces. The mechanism object (typically an instance of class Interface)
must be constructed so that it is properly linked to the object representing
the fluid in the reactor the surface in question faces. The surface
temperature on each side is taken to be equal to the temperature of the
reactor it faces.</p>
<p>Source: <a class="reference external" href="cython/zerodim.html#wall">Python</a> | <a class="reference external" href="./../../doxygen/html/classCantera_1_1Wall.html">C++</a></p>
</li>
<li><p class="first"><strong>Valve</strong>: A valve is a flow devices with mass flow rate that is a function of
the pressure drop across it. The default behavior is linear:</p>
<div class="math">
\[\dot m = K_v (P_1 - P_2)\]</div>
<p>if <span class="math">\(P_1 &gt; P_2.\)</span> Otherwise, <span class="math">\(\dot m = 0\)</span>. However, an arbitrary
function can also be specified, such that</p>
<div class="math">
\[\dot m = F(P_1 - P_2)\]</div>
<p>if <span class="math">\(P_1 &gt; P_2\)</span>, or <span class="math">\(\dot m = 0\)</span> otherwise. It is never possible
for the flow to reverse and go from the downstream to the upstream
reactor/reservoir through a line containing a Valve object.</p>
<p>Valve objects are often used between an upstream reactor and a downstream
reactor or reservoir to maintain them both at nearly the same pressure. By
setting the constant <span class="math">\(K_v\)</span> to a sufficiently large value, very small
pressure differences will result in flow between the reactors that counteracts
the pressure difference.</p>
</li>
<li><p class="first"><strong>Mass Flow Controller</strong>: A mass flow controller maintains a specified mass
flow rate independent of upstream and downstream conditions. The equation used
to compute the mass flow rate is</p>
<div class="math">
\[\dot m = \max(\dot m_0, 0.0)\]</div>
<p>where <span class="math">\(\dot m_0\)</span> is either a constant value or a function of time. Note
that if <span class="math">\(\dot m_0 &lt; 0\)</span>, the mass flow rate will be set to zero, since
reversal of the flow direction is not allowed.</p>
<p>Unlike a real mass flow controller, a MassFlowController object will maintain
the flow even if the downstream pressure is greater than the upstream
pressure. This allows simple implementation of loops, in which exhaust gas
from a reactor is fed back into it through an inlet. But note that this
capability should be used with caution, since no account is taken of the work
required to do this.</p>
</li>
<li><p class="first"><strong>Pressure Controller</strong>: A pressure controller is designed to be used in
conjunction with another &#8216;master&#8217; flow controller, typically a
MassFlowController. The master flow controller is installed on the inlet of
the reactor, and the corresponding PressureController is installed on on
outlet of the reactor. The PressureController mass flow rate is equal to the
master mass flow rate, plus a small correction dependent on the pressure
difference:</p>
<div class="math">
\[\dot m = \dot m_{\rm master} + K_v(P_1 - P_2).\]</div>
</li>
</ul>
<div class="section" id="time-integration">
<h3>Time Integration<a class="headerlink" href="#time-integration" title="Permalink to this headline">&#182;</a></h3>
<p>Cantera provides an ODE solver for solving the stiff equations of reacting
systems. If installed in combination with SUNDIALS, their optimized solver is
used. Starting off the current state of the system, it can be advanced in time
by one of the following methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">step()</span></code>: The step method computes the state of the system at the a priori
unspecified time <span class="math">\(t_{\rm new}\)</span>. The time <span class="math">\(t_{\rm new}\)</span> is internally computed
so that all states of the system only change within a (specifiable) band of
absolute and relative tolerances. Additionally, the time step must not be
larger than a predefined maximum time step <span class="math">\(\Delta t_{\rm max}\)</span>. The new time
<span class="math">\(t_{\rm new}\)</span> is returned by this function.</li>
<li><code class="docutils literal"><span class="pre">advance</span></code><span class="math">\((t_{\rm new})\)</span>: This method computes the state of the system at
time <span class="math">\(t_{\rm new}\)</span>. <span class="math">\(t_{\rm new}\)</span> describes the absolute time from the initial
time of the system. By calling this method in a for loop for pre-defined
times, the state of the system is obtained for exactly the times specified.
Internally, several <code class="docutils literal"><span class="pre">step()</span></code> calls are typically performed to reach the
accurate state at time <span class="math">\(t_{\rm new}\)</span>.</li>
<li><code class="docutils literal"><span class="pre">advance_to_steady_state(max_steps,</span> <span class="pre">residual_threshold,</span> <span class="pre">atol,</span>
<span class="pre">write_residuals)</span></code> [Python interface only]: If the steady state solution of a
reactor network is of interest, this method can be used. Internally, the
steady state is approached by time stepping. The network is considered to be
at steady state if the feature-scaled residual of the state vector is below a
given threshold value (which by default is 10 times the time step rtol).</li>
</ul>
<p>The use of the <code class="docutils literal"><span class="pre">advance</span></code> method in a loop has the advantage that it produces
results corresponding to a predefined time series. These are associated with a
predefined memory consumption and well comparable between simulation runs with
different parameters. However, some detail (e.g. a fast ignition process) might
not be resolved in the output data due to the typically large time steps.</p>
<p>The <code class="docutils literal"><span class="pre">step</span></code> method results in much more data points because of the small
timesteps needed. Additionally, the absolute time has to be kept tracked of
manually.</p>
<p>Even though Cantera comes pre-defined with typical parameters for tolerances
and the maximum internal time step, the solution sometimes diverges. To solve
this problem, three parameters can be tuned: The absolute time stepping
tolerances, the relative time stepping tolerances, and the maximum time step. A
reduction of the latter value is particularly useful when dealing with abrupt
changes in the boundary conditions (e.g. opening/closing valves, see also
example <a class="reference internal" href="cython/examples/reactors_ic_engine.html#py-example-ic-engine-py"><span class="std std-ref">ic_engine.py</span></a>).</p>
</div>
</div>
<div class="section" id="general-usage-in-cantera">
<h2>General Usage in Cantera<a class="headerlink" href="#general-usage-in-cantera" title="Permalink to this headline">&#182;</a></h2>
<p>In Cantera, the following steps are typically necessary to investigate a
reactor network:</p>
<ol class="arabic simple">
<li>Define <code class="docutils literal"><span class="pre">Solution</span></code> objects for the fluids to be flowing through your reactor
network.</li>
<li>Define the reactor type(s) and reservoir(s) that describe your system. Chose
Ideal Gas (Constant Pressure) Reactor(s) if you only consider ideal gas
phases.</li>
<li><em>Optional:</em> Set up the boundary conditions and flow devices between reactors
or reservoirs.</li>
<li>Define a reactor network which contains all the reactors previously created.</li>
<li>Advance the simulation in time, typically in a for- or while-loop. Note that
only the current state is stored in Cantera by default. If you want to
observe the transient states, you manually have to keep track of them.</li>
<li>Analyze the data.</li>
</ol>
<p>Note that Cantera always solves a transient problem. If you are interested in
steady-state conditions, you can run your simulation for a long time until the
states are converged (see e.g. example <a class="reference internal" href="cython/examples/reactors_surf_pfr.html#py-example-surf-pfr-py"><span class="std std-ref">surf_pfr.py</span></a>,
<a class="reference internal" href="cython/examples/reactors_combustor.html#py-example-combustor-py"><span class="std std-ref">combustor.py</span></a>).</p>
<p>Cantera comes with a broad variety of well-commented example scrips for reactor
networks. Please refer to them for further information (<a class="reference internal" href="cython/examples.html#sec-cython-examples"><span class="std std-ref">Python</span></a>, <a class="reference internal" href="matlab/examples.html#sec-matlab-examples"><span class="std std-ref">Matlab</span></a>).</p>
</div>
<div class="section" id="common-reactor-types-and-their-implementation-in-cantera">
<h2>Common Reactor Types and their Implementation in Cantera<a class="headerlink" href="#common-reactor-types-and-their-implementation-in-cantera" title="Permalink to this headline">&#182;</a></h2>
<div class="section" id="batch-reactor-at-constant-volume-or-at-constant-pressure">
<h3>Batch Reactor at Constant Volume or at Constant Pressure<a class="headerlink" href="#batch-reactor-at-constant-volume-or-at-constant-pressure" title="Permalink to this headline">&#182;</a></h3>
<p>If you are interested in how a homogeneous chemical composition changes in time
when it is left to its own, a simple batch reactor can be used. Two versions
are commonly considered: A rigid vessel with fixed volume but variable
pressure, or a system idealized at constant pressure but varying volume.</p>
<p>In Cantera, such a simulation can be performed very easily. The initial state
of the solution can be specified by composition and a set of thermodynamic
parameters (like temperature and pressure) as a standard Cantera solution
object. Upon its base, a general (Ideal Gas) Reactor or an (Ideal Gas) Constant
Pressure Reactor can be created, depending on if a constant volume or constant
pressure batch reactor should be considered, respectively. The behavior of the
solution in time can be simulated as a very simple Reactor Network containing
only the formerly created reactor.</p>
<p>An example for such a Batch Reactor is <a class="reference internal" href="cython/examples/reactors_reactor1.html#py-example-reactor1-py"><span class="std std-ref">reactor1.py</span></a>.</p>
</div>
<div class="section" id="continuously-stirred-tank-reactor">
<h3>Continuously Stirred Tank Reactor<a class="headerlink" href="#continuously-stirred-tank-reactor" title="Permalink to this headline">&#182;</a></h3>
<p>A Continuously Stirred Tank Reactor (CSTR), also often referred to as
Well-Stirred Reactor (WSR), Perfectly Stirred Reactor (PSR), or Longwell
Reactor, is essentially a single Cantera reactor with an inlet, an outlet, and
constant volume. Therefore, the <a class="reference internal" href="#governing-equations-for-single-reactors">Governing Equations for Single Reactors</a>
defined above apply accordingly.</p>
<p>Steady state solutions to CSTRs are often of interest. In this case, the mass
flow rate <span class="math">\(\dot{m}\)</span> is constant and equal at inlet and outlet. The mass
contained in the confinement <span class="math">\(m\)</span> divided by <span class="math">\(\dot{m}\)</span> defines the mean
residence time of the fluid in the confinement.</p>
<p>At steady state, the time derivatives in the governing equations become zero,
and the system of ordinary differential equations can be reduced to a set of
coupled nonlinear algebraic equations. A Newton solver could be used to solve
this system of equations. However, a sophisticated implementation might be
required to account for the strong nonlinearities and the presence of multiple
solutions.</p>
<p>Cantera does not have such a Newton solver implemented. Instead, steady CSTRs
are simulated by considering a time-dependent constant volume reactor with
specified in- and outflow conditions. Starting off at an initial solution, the
reactor network containing this reactor is advanced in time until the state of
the solution is converged. An example for this procedure is
<a class="reference internal" href="cython/examples/reactors_combustor.html#py-example-combustor-py"><span class="std std-ref">combustor.py</span></a>.</p>
<p>A problem can be the ignition of a CSTR: If the reactants are not reactive
enough, the simulation can result in the trivial solution that inflow and
outflow states are identical. To solve this problem, the reactor can be
initialized with a high temperature and/or radical concentration. A good
approach is to use the equilibrium composition of the reactants (which can be
computed using Cantera&#8217;s <code class="docutils literal"><span class="pre">equilibrate</span></code> function) as an initial guess.</p>
</div>
<div class="section" id="plug-flow-reactor">
<h3>Plug-Flow Reactor<a class="headerlink" href="#plug-flow-reactor" title="Permalink to this headline">&#182;</a></h3>
<p>A Plug-Flow Reactor (PFR) represents a steady-state channel with a
cross-sectional area <span class="math">\(A\)</span>. Typically an ideal gas flows through it at a constant
mass flow rate <span class="math">\(\dot{m}\)</span>. Perpendicular to the flow direction, the gas is
considered to be completely homogeneous. In the axial direction <span class="math">\(z\)</span>, the states
of the gas is allowed to change. However, all diffusion processes are neglected.</p>
<p>Plug-Flow Reactors are often used to simulate ignition delay times, emission
formation, and catalytic processes.</p>
<p>The governing equations of Plug-Flow Reactors are <a class="reference internal" href="#kcg2003" id="id1">[KCG2003]</a>:</p>
<ul>
<li><p class="first">Mass conservation:</p>
<div class="math">
\[\frac{d(\rho u A)}{dz} =  P' \sum_k \dot{s}_k W_k\]</div>
<p>where <span class="math">\(u\)</span> is the axial velocity in (m/s) and <span class="math">\(P'\)</span> is the chemically active
channel perimeter in (m) (chemically active perimeter per unit length).</p>
</li>
<li><p class="first">Continuity equation of species <span class="math">\(k\)</span>:</p>
</li>
</ul>
<blockquote>
<div><div class="math">
\[\rho u \frac{d Y_k}{dz} + Y_k P' \sum_k \dot{s}_k W_k =
\dot{\omega}_k W_k + P' \dot{s}_k W_k\]</div>
</div></blockquote>
<ul>
<li><p class="first">Energy conservation:</p>
<div class="math">
\[\rho u A c_p \frac{d T}{d z} =
- A \sum_k h_k \dot{\omega}_k W_k
- P' \sum_k h_k \dot{s}_k W_k
+ U P (T_w - T)\]</div>
<p>where <span class="math">\(U\)</span> is the heat transfer coefficient in (W/m/K), <span class="math">\(P\)</span> is the perimeter of
the duct in (m), and <span class="math">\(T_w\)</span> is the wall temperature in (K). Kinetic and
potential energies are neglected.</p>
</li>
<li><p class="first">Momentum conservation in the axial direction:</p>
<div class="math">
\[\rho u A \frac{d u}{d z} + u P' \sum_k \dot{s}_k W_k =
- \frac{d (p A)}{dz} - \tau_w P\]</div>
<p>where <span class="math">\(\tau_w\)</span> is the wall friction coefficient (which might be computed from
Reynolds number based correlations).</p>
</li>
</ul>
<p>Even though this problem extends geometrically in one direction, it can be
modeled via zero-dimensional reactors: Due to the neglecting of diffusion,
downstream parts of the reactor have no influence on upstream parts. Therefore,
PFRs can be modeled by marching from the beginning to the end of the reactor.</p>
<p>Cantera does not (yet) provide dedicated class to solve the PFR equations (The
<code class="docutils literal"><span class="pre">FlowReactor</span></code> class is currently under development). However, there are two
ways to simulate a PFR with the reactor elements previously presented. Both
rely on the assumption that pressure is approximately constant throughout the
Plug-Flow Reactor and that there is no friction. The momentum conservation
equation is thus neglected.</p>
<div class="section" id="pfr-modeling-by-considering-a-lagrangian-reactor">
<h4>PFR Modeling by Considering a Lagrangian Reactor<a class="headerlink" href="#pfr-modeling-by-considering-a-lagrangian-reactor" title="Permalink to this headline">&#182;</a></h4>
<p>A Plug-Flow Reactor can also be described from a Lagrangian point of view: An
unsteady fluid particle is considered which travels along the axial streamline
through the PFR. Since there is no information traveling upstream, the state
change of the fluid particle can be computed by a forward (upwind) integration
in time. Using the continuity equation, the speed of the particle can be
derived. By integrating the velocity in time, the temporal information can be
translated into the spatial resolution of the PFR.</p>
<p>An example for this procedure can be found in <a class="reference internal" href="cython/examples/reactors_pfr.html#py-example-pfr-py"><span class="std std-ref">pfr.py</span></a>.</p>
</div>
<div class="section" id="pfr-modeling-as-a-series-of-cstrs">
<h4>PFR Modeling as a Series of CSTRs<a class="headerlink" href="#pfr-modeling-as-a-series-of-cstrs" title="Permalink to this headline">&#182;</a></h4>
<p>The Plug-Flow Reactor is spatially discretized into a large number of axially
distributed volumes. These volumes are modeled to be steady-state CSTRs.</p>
<p>The only reason to use this approach as opposed to the Lagrangian one is if you
need to include surface reactions, because the system of equations ends up
being a DAE system instead of an ODE system.</p>
<p>In Cantera, it is sufficient to consider a single reactor and march it forward
in time, because there is no information traveling upstream. The mass flow rate
<span class="math">\(\dot{m}\)</span> through the PFR enters the reactor from an upstream reservoir. For
the first reactor, the reservoir conditions are the inflow boundary conditions
of the PFR. By performing a time integration as described in <a class="reference internal" href="#continuously-stirred-tank-reactor">Continuously
Stirred Tank Reactor</a> until the state of the reactor is converged, the
steady-state CSTR solution is computed. The state of the CSTR is the inlet
boundary condition for the next CSTR downstream.</p>
<p>An example for this procedure can be found in <a class="reference internal" href="cython/examples/reactors_pfr.html#py-example-pfr-py"><span class="std std-ref">pfr.py</span></a> and
<a class="reference internal" href="cython/examples/reactors_surf_pfr.html#py-example-surf-pfr-py"><span class="std std-ref">surf_pfr.py</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="advanced-concepts">
<h2>Advanced Concepts<a class="headerlink" href="#advanced-concepts" title="Permalink to this headline">&#182;</a></h2>
<p>In some cases, Cantera&#8217;s solver is insufficient to describe a certain
configuration. In this situation, Cantera can still be used to provide chemical
and thermodynamic computations, but external ODE solvers can be applied. See
example <a class="reference internal" href="cython/examples/reactors_custom.html#py-example-custom-py"><span class="std std-ref">custom.py</span></a>.</p>
</div>
<div class="section" id="literature">
<h2>Literature<a class="headerlink" href="#literature" title="Permalink to this headline">&#182;</a></h2>
<p>For further reading, the following books are recommended:</p>
<table class="docutils citation" frame="void" id="kcg2003" rules="none">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[KCG2003]</a></td><td>Kee, Coltrin, Glarborg: <em>Chemically Reacting Flow</em>.
Wiley-Interscience, 2003</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="tur2000" rules="none">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label">[Tur2000]</td><td>Turns: <em>An Introduction to Combustion: Concepts and Applications</em>,
McGraw Hill, 2000</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index">index</a></li>
        <li class="right">
          <a href="py-modindex.html" title="Python Module Index">modules</a> |</li>
        <li class="right">
          <a href="flames.html" title="One-Dimensional Flames">next</a> |</li>
        <li class="right">
          <a href="cti/example-combustion.html" title="Example: Hydrogen Combustion">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Cantera</a> &#187;</li>
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2001-2018, Cantera Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>