<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Cantera: Equilibrium Solver Capability</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Cantera
   &#160;<span id="projectnumber">2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Equilibrium Solver Capability</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCantera_1_1MultiPhase.html">MultiPhase</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for multiphase mixtures.  <a href="classCantera_1_1MultiPhase.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVCSnonideal_1_1vcs__MultiPhaseEquil.html">vcs_MultiPhaseEquil</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespaceCantera.html" title="Provides class Nucleus.">Cantera</a>'s Interface to the Multiphase chemical equilibrium solver.  <a href="classVCSnonideal_1_1vcs__MultiPhaseEquil.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa27374c5b1714a38464ac5f0c5dc864b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gaa27374c5b1714a38464ac5f0c5dc864b">equilibrate</a> (thermo_t &amp;s, const char *XY, int solver=-1, doublereal rtol=1.0e-9, int maxsteps=VCS_MAXSTEPS, int maxiter=100, int loglevel=-99)</td></tr>
<tr class="memdesc:gaa27374c5b1714a38464ac5f0c5dc864b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrate a <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties.">ThermoPhase</a> object.  <a href="#gaa27374c5b1714a38464ac5f0c5dc864b"></a><br/></td></tr>
<tr class="separator:gaa27374c5b1714a38464ac5f0c5dc864b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1afcf76889207992decc8faf64fa3d08"><td class="memItemLeft" align="right" valign="top">doublereal&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga1afcf76889207992decc8faf64fa3d08">equilibrate</a> (MultiPhase &amp;s, const char *XY, doublereal rtol=1.0e-9, int maxsteps=5000, int maxiter=100, int loglevel=-99)</td></tr>
<tr class="memdesc:ga1afcf76889207992decc8faf64fa3d08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrate a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a> object.  <a href="#ga1afcf76889207992decc8faf64fa3d08"></a><br/></td></tr>
<tr class="separator:ga1afcf76889207992decc8faf64fa3d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga98ceb5c63edae28641b84864c87c197b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga98ceb5c63edae28641b84864c87c197b">BasisOptimize</a> (int *usedZeroedSpecies, bool doFormRxn, MultiPhase *mphase, std::vector&lt; size_t &gt; &amp;orderVectorSpecies, std::vector&lt; size_t &gt; &amp;orderVectorElements, vector_fp &amp;formRxnMatrix)</td></tr>
<tr class="memdesc:ga98ceb5c63edae28641b84864c87c197b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose the optimum basis of species for the equilibrium calculations.  <a href="#ga98ceb5c63edae28641b84864c87c197b"></a><br/></td></tr>
<tr class="separator:ga98ceb5c63edae28641b84864c87c197b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3d8afe5b67f11c8143d89892fc6e8a2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gad3d8afe5b67f11c8143d89892fc6e8a2">ElemRearrange</a> (size_t nComponents, const vector_fp &amp;elementAbundances, MultiPhase *mphase, std::vector&lt; size_t &gt; &amp;orderVectorSpecies, std::vector&lt; size_t &gt; &amp;orderVectorElements)</td></tr>
<tr class="memdesc:gad3d8afe5b67f11c8143d89892fc6e8a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine handles the potential rearrangement of the constraint equations represented by the Formula Matrix.  <a href="#gad3d8afe5b67f11c8143d89892fc6e8a2"></a><br/></td></tr>
<tr class="separator:gad3d8afe5b67f11c8143d89892fc6e8a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a76e36f860300d83133ec58ae4536ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga2a76e36f860300d83133ec58ae4536ad">vcs_equilibrate</a> (thermo_t &amp;s, const char *XY, int estimateEquil=0, int printLvl=0, int solver=-1, doublereal rtol=1.0e-9, int maxsteps=VCS_MAXSTEPS, int maxiter=100, int loglevel=-99)</td></tr>
<tr class="memdesc:ga2a76e36f860300d83133ec58ae4536ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a single-phase chemical solution to chemical equilibrium.  <a href="#ga2a76e36f860300d83133ec58ae4536ad"></a><br/></td></tr>
<tr class="separator:ga2a76e36f860300d83133ec58ae4536ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga490ec506a99ccb320418a56a6f57f13d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga490ec506a99ccb320418a56a6f57f13d">vcs_equilibrate</a> (MultiPhase &amp;s, const char *XY, int estimateEquil=0, int printLvl=0, int solver=2, doublereal rtol=1.0e-9, int maxsteps=VCS_MAXSTEPS, int maxiter=100, int loglevel=-99)</td></tr>
<tr class="memdesc:ga490ec506a99ccb320418a56a6f57f13d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a multi-phase chemical solution to chemical equilibrium.  <a href="#ga490ec506a99ccb320418a56a6f57f13d"></a><br/></td></tr>
<tr class="separator:ga490ec506a99ccb320418a56a6f57f13d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93d2e71d2049a4e6077626fb561e721d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga93d2e71d2049a4e6077626fb561e721d">vcs_equilibrate_1</a> (MultiPhase &amp;s, int ixy, int estimateEquil=0, int printLvl=0, int solver=2, doublereal rtol=1.0e-9, int maxsteps=VCS_MAXSTEPS, int maxiter=100, int loglevel=-99)</td></tr>
<tr class="memdesc:ga93d2e71d2049a4e6077626fb561e721d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a multi-phase chemical solution to chemical equilibrium.  <a href="#ga93d2e71d2049a4e6077626fb561e721d"></a><br/></td></tr>
<tr class="separator:ga93d2e71d2049a4e6077626fb561e721d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p><a class="el" href="namespaceCantera.html" title="Provides class Nucleus.">Cantera</a> has several different equilibrium routines. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaa27374c5b1714a38464ac5f0c5dc864b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int equilibrate </td>
          <td>(</td>
          <td class="paramtype">thermo_t &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>solver</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">doublereal&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1.0e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxsteps</em> = <code><a class="el" href="vcs__defs_8h.html#a330b361758b3209d39aebbabbb7bfdb2">VCS_MAXSTEPS</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loglevel</em> = <code>-99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrate a <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties.">ThermoPhase</a> object. </p>
<p>Set a single-phase chemical solution to chemical equilibrium. This is a convenience function that uses one or the other of the two chemical equilibrium solvers. The XY parameter indicates what two thermodynamic quantities, other than element composition, are to be held constant during the equilibration process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties.">ThermoPhase</a> object that will be equilibrated. </td></tr>
    <tr><td class="paramname">XY</td><td>String representation of what two properties are being held constant </td></tr>
    <tr><td class="paramname">solver</td><td>ID of the solver to be used to equilibrate the phase. If solver = 0, the <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions.">ChemEquil</a> solver will be used, and if solver = 1, the <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver will be used (slower than <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions.">ChemEquil</a>, but more stable). If solver &lt; 0 (default, then <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions.">ChemEquil</a> will be tried first, and if it fails <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> will be tried. </td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance </td></tr>
    <tr><td class="paramname">maxsteps</td><td>Maximum number of steps to take to find the solution </td></tr>
    <tr><td class="paramname">maxiter</td><td>For the <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver only, this is the maximum number of outer temperature or pressure iterations to take when T and/or P is not held fixed. </td></tr>
    <tr><td class="paramname">loglevel</td><td>loglevel Controls amount of diagnostic output. loglevel = 0 suppresses diagnostics, and increasingly-verbose messages are written as loglevel increases. The messages are written to a file in HTML format for viewing in a web browser. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__HTML__logs.html">Writing HTML Logfiles</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Return variable is equal to the number of subroutine attempts it took to equilibrate the system. </dd></dl>

<p>Definition at line <a class="el" href="equilibrate_8cpp_source.html#l00100">100</a> of file <a class="el" href="equilibrate_8cpp_source.html">equilibrate.cpp</a>.</p>

<p>References <a class="el" href="global_8cpp_source.html#l00085">Cantera::addLogEntry()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00114">MultiPhase::addPhase()</a>, <a class="el" href="global_8cpp_source.html#l00080">Cantera::beginLogGroup()</a>, <a class="el" href="global_8cpp_source.html#l00105">Cantera::endLogGroup()</a>, <a class="el" href="equilibrate_8cpp_source.html#l00024">Cantera::equilibrate()</a>, <a class="el" href="ChemEquil_8cpp_source.html#l00452">ChemEquil::equilibrate()</a>, <a class="el" href="Phase_8cpp_source.html#l00130">Phase::id()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00193">MultiPhase::init()</a>, <a class="el" href="ChemEquil_8h_source.html#l00043">EquilOpt::maxIterations</a>, <a class="el" href="ChemEquil_8h_source.html#l00127">ChemEquil::options</a>, <a class="el" href="ChemEquil_8h_source.html#l00041">EquilOpt::relTolerance</a>, <a class="el" href="ctexceptions_8cpp_source.html#l00033">CanteraError::save()</a>, <a class="el" href="ThermoPhase_8cpp_source.html#l01106">ThermoPhase::setElementPotentials()</a>, and <a class="el" href="vcs__equilibrate_8cpp_source.html#l00084">Cantera::vcs_equilibrate()</a>.</p>

</div>
</div>
<a class="anchor" id="ga1afcf76889207992decc8faf64fa3d08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">doublereal equilibrate </td>
          <td>(</td>
          <td class="paramtype">MultiPhase &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">doublereal&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1.0e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxsteps</em> = <code>5000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loglevel</em> = <code>-99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrate a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a> object. </p>
<p>Equilibrate a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a> object. The XY parameter indicates what two thermodynamic quantities, other than element composition, are to be held constant during the equilibration process.</p>
<p>This is the top-level driver for multiphase equilibrium. It doesn't do much more than call the equilibrate method of class <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a>, except that it adds some messages to the logfile, if loglevel is set &gt; 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a> object that will be equilibrated. </td></tr>
    <tr><td class="paramname">XY</td><td>String representation of what is being held constant </td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance </td></tr>
    <tr><td class="paramname">maxsteps</td><td>Maximum number of steps </td></tr>
    <tr><td class="paramname">maxiter</td><td>Maximum iterations </td></tr>
    <tr><td class="paramname">loglevel</td><td>loglevel</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return variable is equal to the number of subroutine attempts it took to equilibrate the system. </dd></dl>

<p>Definition at line <a class="el" href="equilibrate_8cpp_source.html#l00024">24</a> of file <a class="el" href="equilibrate_8cpp_source.html">equilibrate.cpp</a>.</p>

<p>References <a class="el" href="ChemEquil_8cpp_source.html#l00037">Cantera::_equilflag()</a>, <a class="el" href="global_8cpp_source.html#l00085">Cantera::addLogEntry()</a>, <a class="el" href="global_8cpp_source.html#l00080">Cantera::beginLogGroup()</a>, <a class="el" href="global_8cpp_source.html#l00105">Cantera::endLogGroup()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00679">MultiPhase::equilibrate()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00193">MultiPhase::init()</a>, <a class="el" href="global_8cpp_source.html#l00156">Cantera::lastErrorMessage()</a>, and <a class="el" href="ctexceptions_8cpp_source.html#l00033">CanteraError::save()</a>.</p>

<p>Referenced by <a class="el" href="equilibrate_8cpp_source.html#l00100">Cantera::equilibrate()</a>, and <a class="el" href="vcs__equilibrate_8cpp_source.html#l00084">Cantera::vcs_equilibrate()</a>.</p>

</div>
</div>
<a class="anchor" id="ga98ceb5c63edae28641b84864c87c197b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Cantera::BasisOptimize </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>usedZeroedSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doFormRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MultiPhase *&#160;</td>
          <td class="paramname"><em>mphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorElements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector_fp &amp;&#160;</td>
          <td class="paramname"><em>formRxnMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Choose the optimum basis of species for the equilibrium calculations. </p>
<p>This is done by choosing the species with the largest mole fraction not currently a linear combination of the previous components. Then, calculate the stoichiometric coefficient matrix for that basis.</p>
<p>Calculates the identity of the component species in the mechanism. Rearranges the solution data to put the component data at the front of the species list.</p>
<p>Then, calculates SC(J,I) the formation reactions for all noncomponent species in the mechanism.</p>
<h2>Input</h2>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mphase</td><td>Pointer to the multiphase object. Contains the species mole fractions, which are used to pick the current optimal species component basis. </td></tr>
    <tr><td class="paramname">orderVectorElements</td><td>Order vector for the elements. The element rows in the formula matrix are rearranged according to this vector. </td></tr>
    <tr><td class="paramname">orderVectorSpecies</td><td>Order vector for the species. The species are rearranged according to this formula. The first nCompoments of this vector contain the calculated species components on exit. </td></tr>
    <tr><td class="paramname">doFormRxn</td><td>If true, the routine calculates the formation reaction matrix based on the calculated component species. If false, this step is skipped.</td></tr>
  </table>
  </dd>
</dl>
<h2>Output</h2>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">usedZeroedSpecies</td><td>= If true, then a species with a zero concentration was used as a component. The problem may be converged. </td></tr>
    <tr><td class="paramname">formRxnMatrix</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the number of components. </dd></dl>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00309">ChemEquil::estimateElementPotentials()</a>.</p>

</div>
</div>
<a class="anchor" id="gad3d8afe5b67f11c8143d89892fc6e8a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Cantera::ElemRearrange </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector_fp &amp;&#160;</td>
          <td class="paramname"><em>elementAbundances</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MultiPhase *&#160;</td>
          <td class="paramname"><em>mphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorElements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine handles the potential rearrangement of the constraint equations represented by the Formula Matrix. </p>
<p>Rearrangement is only necessary when the number of components is less than the number of elements. For this case, some constraints can never be satisfied exactly, because the range space represented by the Formula Matrix of the components can't span the extra space. These constraints, which are out of the range space of the component Formula matrix entries, are migrated to the back of the Formula matrix.</p>
<p>A prototypical example is an extra element column in FormulaMatrix[], which is identically zero. For example, let's say that argon is has an element column in FormulaMatrix[], but no species in the mechanism actually contains argon. Then, nc &lt; ne. Unless the entry for desired element abundance vector for Ar is zero, then this element abundance constraint can never be satisfied. The constraint vector is not in the range space of the formula matrix. Also, without perturbation of FormulaMatrix[], BasisOptimize[] would produce a zero pivot because the matrix would be singular (unless the argon element column was already the last column of FormulaMatrix[]. This routine borrows heavily from BasisOptimize algorithm. It finds nc constraints which span the range space of the Component Formula matrix, and assigns them as the first nc components in the formula matrix. This guarantees that BasisOptimize has a nonsingular matrix to invert. input </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nComponents</td><td>Number of components calculated previously.</td></tr>
    <tr><td class="paramname">elementAbundances</td><td>Current value of the element abundances</td></tr>
    <tr><td class="paramname">mphase</td><td>Input pointer to a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a> object</td></tr>
    <tr><td class="paramname">orderVectorSpecies</td><td>input vector containing the ordering of the global species in mphase. This is used to extract the component basis of the mphase object.</td></tr>
  </table>
  </dd>
</dl>
<p>output </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">orderVectorElements</td><td>Output vector containing the order of the elements that is necessary for calculation of the formula matrix. </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00309">ChemEquil::estimateElementPotentials()</a>.</p>

</div>
</div>
<a class="anchor" id="ga2a76e36f860300d83133ec58ae4536ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vcs_equilibrate </td>
          <td>(</td>
          <td class="paramtype">thermo_t &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>estimateEquil</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>printLvl</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>solver</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">doublereal&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1.0e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxsteps</em> = <code><a class="el" href="vcs__defs_8h.html#a330b361758b3209d39aebbabbb7bfdb2">VCS_MAXSTEPS</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loglevel</em> = <code>-99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a single-phase chemical solution to chemical equilibrium. </p>
<p>The function uses the element abundance vector that is currently consistent with the composition within the phase itself. Two other thermodynamic quantities, determined by the XY string, are held constant during the equilibration. This is a convenience function that uses one or the other of the two chemical equilibrium solvers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The object to set to an equilibrium state</td></tr>
    <tr><td class="paramname">XY</td><td>An integer specifying the two properties to be held constant.</td></tr>
    <tr><td class="paramname">estimateEquil</td><td>integer indicating whether the solver should estimate its own initial condition. If 0, the initial mole fraction vector in the ThermoPhase object is used as the initial condition. If 1, the initial mole fraction vector is used if the element abundances are satisfied. if -1, the initial mole fraction vector is thrown out, and an estimate is formulated.</td></tr>
    <tr><td class="paramname">printLvl</td><td>Determines the amount of printing that gets sent to stdout from the vcs package (Note, you may have to compile with debug flags to get some printing).</td></tr>
    <tr><td class="paramname">solver</td><td>The equilibrium solver to use. If solver = 0, the <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions.">ChemEquil</a> solver will be used, and if solver = 1, the vcs_MultiPhaseEquil solver will be used (slower than <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions.">ChemEquil</a>, but more stable). If solver &lt; 0 (default, then <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions.">ChemEquil</a> will be tried first, and if it fails vcs_MultiPhaseEquil will be tried.</td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance of the solve. Defaults to 1.0E-9.</td></tr>
    <tr><td class="paramname">maxsteps</td><td>The maximum number of steps to take to find the solution.</td></tr>
    <tr><td class="paramname">maxiter</td><td>For the <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver only, this is the maximum number of outer temperature or pressure iterations to take when T and/or P is not held fixed.</td></tr>
    <tr><td class="paramname">loglevel</td><td>Controls amount of diagnostic output. loglevel = 0 suppresses diagnostics, and increasingly-verbose messages are written as loglevel increases. The messages are written to a file in HTML format for viewing in a web browser. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__HTML__logs.html">Writing HTML Logfiles</a> </dd></dl>

<p>Definition at line <a class="el" href="vcs__equilibrate_8cpp_source.html#l00084">84</a> of file <a class="el" href="vcs__equilibrate_8cpp_source.html">vcs_equilibrate.cpp</a>.</p>

<p>References <a class="el" href="global_8cpp_source.html#l00085">Cantera::addLogEntry()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00114">MultiPhase::addPhase()</a>, <a class="el" href="global_8cpp_source.html#l00080">Cantera::beginLogGroup()</a>, <a class="el" href="global_8cpp_source.html#l00105">Cantera::endLogGroup()</a>, <a class="el" href="equilibrate_8cpp_source.html#l00024">Cantera::equilibrate()</a>, <a class="el" href="ChemEquil_8cpp_source.html#l00452">ChemEquil::equilibrate()</a>, <a class="el" href="Phase_8cpp_source.html#l00130">Phase::id()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00193">MultiPhase::init()</a>, <a class="el" href="ChemEquil_8h_source.html#l00043">EquilOpt::maxIterations</a>, <a class="el" href="ChemEquil_8h_source.html#l00127">ChemEquil::options</a>, <a class="el" href="ChemEquil_8h_source.html#l00041">EquilOpt::relTolerance</a>, <a class="el" href="ctexceptions_8cpp_source.html#l00033">CanteraError::save()</a>, and <a class="el" href="ThermoPhase_8cpp_source.html#l01106">ThermoPhase::setElementPotentials()</a>.</p>

<p>Referenced by <a class="el" href="equilibrate_8cpp_source.html#l00100">Cantera::equilibrate()</a>.</p>

</div>
</div>
<a class="anchor" id="ga490ec506a99ccb320418a56a6f57f13d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vcs_equilibrate </td>
          <td>(</td>
          <td class="paramtype">MultiPhase &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>estimateEquil</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>printLvl</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>solver</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">doublereal&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1.0e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxsteps</em> = <code><a class="el" href="vcs__defs_8h.html#a330b361758b3209d39aebbabbb7bfdb2">VCS_MAXSTEPS</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loglevel</em> = <code>-99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a multi-phase chemical solution to chemical equilibrium. </p>
<p>This function uses the vcs_MultiPhaseEquil interface to the vcs solver. The function uses the element abundance vector that is currently consistent with the composition within the phases themselves. Two other thermodynamic quantities, determined by the XY string, are held constant during the equilibration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The object to set to an equilibrium state</td></tr>
    <tr><td class="paramname">XY</td><td>A character string representing the unknowns to be held constant</td></tr>
    <tr><td class="paramname">estimateEquil</td><td>integer indicating whether the solver should estimate its own initial condition. If 0, the initial mole fraction vector in the ThermoPhase object is used as the initial condition. If 1, the initial mole fraction vector is used if the element abundances are satisfied. if -1, the initial mole fraction vector is thrown out, and an estimate is formulated.</td></tr>
    <tr><td class="paramname">printLvl</td><td>Determines the amount of printing that gets sent to stdout from the vcs package (Note, you may have to compile with debug flags to get some printing).</td></tr>
    <tr><td class="paramname">solver</td><td>Determines which solver is used.<ul>
<li>1 <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver</li>
<li>2 VCSnonideal Solver (default)</li>
</ul>
</td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance of the solve. Defaults to 1.0E-9.</td></tr>
    <tr><td class="paramname">maxsteps</td><td>The maximum number of steps to take to find the solution.</td></tr>
    <tr><td class="paramname">maxiter</td><td>For the <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver only, this is the maximum number of outer temperature or pressure iterations to take when T and/or P is not held fixed.</td></tr>
    <tr><td class="paramname">loglevel</td><td>Controls amount of diagnostic output. loglevel = 0 suppresses diagnostics, and increasingly-verbose messages are written as loglevel increases. The messages are written to a file in HTML format for viewing in a web browser. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__HTML__logs.html">Writing HTML Logfiles</a> </dd></dl>

<p>Definition at line <a class="el" href="vcs__equilibrate_8cpp_source.html#l00244">244</a> of file <a class="el" href="vcs__equilibrate_8cpp_source.html">vcs_equilibrate.cpp</a>.</p>

<p>References <a class="el" href="ChemEquil_8cpp_source.html#l00037">Cantera::_equilflag()</a>, and <a class="el" href="vcs__equilibrate_8cpp_source.html#l00303">Cantera::vcs_equilibrate_1()</a>.</p>

</div>
</div>
<a class="anchor" id="ga93d2e71d2049a4e6077626fb561e721d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vcs_equilibrate_1 </td>
          <td>(</td>
          <td class="paramtype">MultiPhase &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ixy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>estimateEquil</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>printLvl</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>solver</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">doublereal&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1.0e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxsteps</em> = <code><a class="el" href="vcs__defs_8h.html#a330b361758b3209d39aebbabbb7bfdb2">VCS_MAXSTEPS</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loglevel</em> = <code>-99</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a multi-phase chemical solution to chemical equilibrium. </p>
<p>This function uses the vcs_MultiPhaseEquil interface to the vcs solver. The function uses the element abundance vector that is currently consistent with the composition within the phases themselves. Two other thermodynamic quantities, determined by the XY string, are held constant during the equilibration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures.">MultiPhase</a> object to be set to an equilibrium state</td></tr>
    <tr><td class="paramname">ixy</td><td>An integer specifying the two properties to be held constant.</td></tr>
    <tr><td class="paramname">estimateEquil</td><td>integer indicating whether the solver should estimate its own initial condition. If 0, the initial mole fraction vector in the ThermoPhase object is used as the initial condition. If 1, the initial mole fraction vector is used if the element abundances are satisfied. if -1, the initial mole fraction vector is thrown out, and an estimate is formulated.</td></tr>
    <tr><td class="paramname">printLvl</td><td>Determines the amount of printing that gets sent to stdout from the vcs package (Note, you may have to compile with debug flags to get some printing).</td></tr>
    <tr><td class="paramname">solver</td><td>Determines which solver is used.<ul>
<li>1 <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver</li>
<li>2 VCSnonideal Solver (default)</li>
</ul>
</td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance of the solve. Defaults to 1.0E-9.</td></tr>
    <tr><td class="paramname">maxsteps</td><td>The maximum number of steps to take to find the solution.</td></tr>
    <tr><td class="paramname">maxiter</td><td>For the <a class="el" href="classCantera_1_1MultiPhaseEquil.html" title="Multiphase chemical equilibrium solver.">MultiPhaseEquil</a> solver only, this is the maximum number of outer temperature or pressure iterations to take when T and/or P is not held fixed.</td></tr>
    <tr><td class="paramname">loglevel</td><td>Controls amount of diagnostic output. loglevel = 0 suppresses diagnostics, and increasingly-verbose messages are written as loglevel increases. The messages are written to a file in HTML format for viewing in a web browser. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__HTML__logs.html">Writing HTML Logfiles</a> </dd></dl>

<p>Definition at line <a class="el" href="vcs__equilibrate_8cpp_source.html#l00303">303</a> of file <a class="el" href="vcs__equilibrate_8cpp_source.html">vcs_equilibrate.cpp</a>.</p>

<p>References <a class="el" href="global_8cpp_source.html#l00085">Cantera::addLogEntry()</a>, <a class="el" href="global_8cpp_source.html#l00080">Cantera::beginLogGroup()</a>, <a class="el" href="global_8cpp_source.html#l00105">Cantera::endLogGroup()</a>, <a class="el" href="vcs__MultiPhaseEquil_8cpp_source.html#l00526">vcs_MultiPhaseEquil::equilibrate()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00679">MultiPhase::equilibrate()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00193">MultiPhase::init()</a>, <a class="el" href="stringUtils_8cpp_source.html#l00066">Cantera::int2str()</a>, <a class="el" href="global_8cpp_source.html#l00156">Cantera::lastErrorMessage()</a>, <a class="el" href="ckr__utils_8h_source.html#l00057">ckr::max()</a>, <a class="el" href="vcs__MultiPhaseEquil_8cpp_source.html#l00746">vcs_MultiPhaseEquil::reportCSV()</a>, and <a class="el" href="ctexceptions_8cpp_source.html#l00033">CanteraError::save()</a>.</p>

<p>Referenced by <a class="el" href="vcs__equilibrate_8cpp_source.html#l00244">Cantera::vcs_equilibrate()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
