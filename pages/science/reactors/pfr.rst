.. title: Plug Flow Reactor
.. has_math: true

.. jumbotron::

   .. raw:: html

      <h1 class="display-4">Plug Flow Reactor</h1>

   .. class:: lead

      This page shows the derivation of the governing equations used in
      Cantera's Plug Flow Reactor model.

Plug Flow Reactor
*****************

A Plug Flow Reactor (PFR) represents a steady-state flow in a channel. Perpendicular to
the flow direction, the gas is considered to be completely homogeneous. In the axial
direction :math:`z`, the state of the gas is allowed to change. However, all diffusion
processes are neglected.

In addition, the interior surface of the reactor may consist of one or more
catalytically active surfaces where heterogenous reactions occur.

Plug-Flow Reactors are often used to simulate emission formation and catalytic processes.

A Plug Flow Reactor is defined by the state variables:

- :math:`\rho`, the density of the fluid phase (in kg/m\ :sup:`3`)

- :math:`u`, the velocity of the fluid phase (in m/s)

- :math:`p`, the pressure (in Pa)

- :math:`T`, the temperature (in K)

- :math:`Y_k`, the mass fractions for each fluid phase species (dimensionless)

- :math:`\theta_{i,j}`, the coverage of each surface species :math:`i` on each surface
  :math:`j` (dimensionless)

The reactor geometry is defined by the length :math:`L`, total volume :math:`V`, and the
surface area :math:`A_{s,j}` for each surface, where the surface area per unit length is
assumed to be a constant along the length of the reactor.

The governing equations for a PFR are a system of differential-algebraic equations,
which depend on the spatial derivatives of some but not all of the state variables. The
plug flow reactor model in Cantera is implemented by class `FlowReactor <{{% ct_docs
doxygen/html/da/dae/classCantera_1_1FlowReactor.html %}}>`__.


*Equation of state*

The fluid satisfies the ideal gas law:

.. math::

   \rho = p \frac{R}{\overline{W}} T

where :math:`R` is the universal gas constant and :math:`\overline{W}` is the mixture
molecular weight.

*Mass conservation:*

The net rate at which fluid phase species are generated by reactions on the walls (per
unit cross sectional area) can be defined as

.. math::

   \dot{m}_s = \sum_j \frac{A_{s,j}}{V} \left(\sum_k \dot{s}_{k,j} W_k\right)

where :math:`\dot{s}_{k,j}` is the net rate of production of species :math:`k` on
surface :math:`j` and :math:`W_k` is the molecular weight of species :math:`k`. The
overall mass conservation equation for the reactor can then be written as:

.. math::

   u \frac{d\rho}{dz} + \rho \frac{du}{dz} = \dot{m}_s
   \tag{1}

*Momentum conservation in the axial direction:*

.. math::

  \rho u \frac{du}{dz} = - u \dot{m}_s - \frac{dp}{dz}
  \tag{2}

*Energy conservation:*

.. math::

   \rho u c_p \frac{dT}{dz} =
      - \sum_k \hat{h}_k \dot{\omega}_k
      - \sum_j \frac{A_{s,j}}{V} \left(\sum_k \hat{h}_k \dot{s}_{k,j}\right)
   \tag{3}

where :math:`c_p` is the specific heat capacity of the mixture and :math:`\hat{h}_k` is
the molar enthalpy of species :math:`k`. Kinetic and potential energies are neglected.

*Conservation equation for fluid species* :math:`k`:

.. math::

  \rho u \frac{d Y_k}{dz} = - Y_k \dot{m}_s
                            + \dot{\omega}_k W_k + \sum_j \frac{A_{s,j}}{V} \dot{s}_k W_k
  \tag{4}


*Conservation equation for surface species* :math:`i,j`:

Because the PFR is modeled as steady state, net rate of production for each surface
species must be zero. To satisfy the constraint that the total surface coverage is 1,
the conservation equation for the first surface species on each surface is replaced
by this constraint:

.. math::

   \dot{s}_{i,j} = 0,\quad i \ne 0
   \tag{5}

   \dot{s}_{0,j} = 1 - \sum_{i\ne 0} \theta_{i,j}
   \tag{6}

Integrating the PFR
-------------------

Because diffusion is neglected, downstream parts of the reactor have no influence on
upstream parts. Therefore, PFRs can be integrated as initial value problems, starting
from the composition at the inlet. Some care is required to determine initial values for
the algebraic variables (the surface species coverages) and the time derivatives for the
differential variables (the other state variables) that are consistent with the
governing equations.

To do this, we first solve the steady-state problem for each surface, holding the fluid
phase composition, temperature, and pressure fixed at the inlet values to determine the
values of :math:`\theta_{i,j}(z=0)`. Then, we construct a linear system comprising the
ideal gas law, differentiated with respect to :math:`z` and equations (1), (2), (3), and
(4) evaluated at :math:`z=0`. This system is then solved to obtain the values of
:math:`d\rho/dz`, :math:`du/dz`, :math:`dp/dz`, :math:`dT/dz`, and :math:`dY_k/dz` at
:math:`z=0`.

Examples
--------

- `Partial oxidation of methane over a platinum catalyst
  </examples/python/reactors/surf_pfr.py.html>`__
- `silicon nitride (Si3N4) deposition from ammonia (NH3) and silicon tetrafluoride
  (SiF4) </examples/python/surface_chemistry/1D_pfr_surfchem.py.html>`__
